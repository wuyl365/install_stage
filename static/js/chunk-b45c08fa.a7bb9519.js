(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b45c08fa"],{ad8f:function(e,t,a){"use strict";a.d(t,"c",(function(){return l})),a.d(t,"d",(function(){return i})),a.d(t,"f",(function(){return r})),a.d(t,"b",(function(){return o})),a.d(t,"g",(function(){return c})),a.d(t,"e",(function(){return s})),a.d(t,"a",(function(){return u}));var n=a("b775");function l(e){return Object(n["a"])({url:"/admin/api/v1/application/detail",method:"get"})}function i(e){return Object(n["a"])({url:"/admin/api/v1/application/list",method:"get",params:e})}function r(e){return Object(n["a"])({url:"/admin/api/v1/channel/list",method:"get",params:e})}function o(e){return Object(n["a"])({url:"/admin/api/v1/channel/create",method:"post",params:e})}function c(e){return Object(n["a"])({url:"/admin/api/v1/channel/statistic",method:"get",params:e})}function s(e){return Object(n["a"])({url:"/admin/api/v1/application/statistic",method:"get",params:e})}function u(e){return Object(n["a"])({url:"/admin/api/v1/application/create",method:"post",params:e})}},fcd2:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"channels-container",staticStyle:{margin:"20px"}},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.create(t)}}},[e._v("添加h5渠道")]),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{fixed:"",prop:"channel_code",label:"渠道编号",width:"150"}}),a("el-table-column",{attrs:{fixed:"",prop:"channel_name",label:"渠道名称",width:"120"}}),a("el-table-column",{attrs:{fixed:"",prop:"channel_page_url",label:"渠道链接",width:"280"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("a",{attrs:{href:"javascript:;"},on:{click:function(a){return e.linkJump(t.row)}}},[e._v(e._s(t.row.channel_page_url))])])]}}])}),a("el-table-column",{attrs:{fixed:"",prop:"created_at",label:"创建时间",width:"160"}})],1),a("div",{staticStyle:{"text-align":"center","margin-top":"20px",margin:"20px"}},[a("el-pagination",{attrs:{small:"small","current-page":e.currentPage,"page-size":e.pageSize,layout:"total, prev, pager, next, jumper",total:e.total},on:{"current-change":e.handleCurrentChange}})],1),e.dialogFormVisible?a("div",[a("CreateDialog",{attrs:{"is-show":e.dialogFormVisible,"create-success-block":e.update,"is-edit":e.isDiaLogFormEdit,"edit-data":e.editData}})],1):e._e()],1)},l=[],i=(a("e9c4"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{visible:e.isVisiable,title:"新增H5渠道",width:"80%","before-close":e.handleClose},on:{"update:visible":function(t){e.isVisiable=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[a("span",{staticClass:"dialog-footer"},[a("el-button",{nativeOn:{click:function(t){return t.preventDefault(),e.cancel(t)}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.confirm("ruleForm")}}},[e._v(" 确认 ")])],1)]},proxy:!0}])},[a("el-form",{ref:"ruleForm",attrs:{"label-width":"120px",model:e.ruleForm,rules:e.rules}},[a("el-form-item",{attrs:{label:"渠道编号",prop:"channelId"}},[a("el-input",{attrs:{readonly:e.codeReadOnly,placeholder:"请输入渠道编号"},model:{value:e.ruleForm.channelId,callback:function(t){e.$set(e.ruleForm,"channelId",t)},expression:"ruleForm.channelId"}})],1),a("el-form-item",{attrs:{label:"渠道名称",prop:"channelName"}},[a("el-input",{attrs:{placeholder:"请输入渠道名称"},model:{value:e.ruleForm.channelName,callback:function(t){e.$set(e.ruleForm,"channelName",t)},expression:"ruleForm.channelName"}})],1),a("el-form-item",{attrs:{label:"落地页URL",prop:"channelUrl"}},[a("el-input",{attrs:{placeholder:"请输入渠道名称"},model:{value:e.ruleForm.channelUrl,callback:function(t){e.$set(e.ruleForm,"channelUrl",t)},expression:"ruleForm.channelUrl"}})],1)],1)],1)}),r=[],o=a("ad8f"),c=a("5f87"),s={name:"CreateDialog",props:{isShow:Boolean,createSuccessBlock:Function,isEdit:Boolean,editData:Object},data:function(){return{ruleForm:{channelId:"",channelName:"",channelUrl:""},rules:{channelId:[{required:!0,message:"请输入渠道编号",trigger:"blur"},{min:1,max:100,message:"长度在 1 到 100 个字符",trigger:"blur"}],channelName:[{required:!0,message:"请输入渠道名称",trigger:"blur"},{min:1,max:100,message:"长度在 1 到 100 个字符",trigger:"blur"}],channelUrl:[{required:!0,message:"请输入落地页url",trigger:"blur"},{min:1,max:100,message:"长度在 1 到 100 个字符",trigger:"blur"}]},isVisiable:this.isShow,codeReadOnly:!1}},computed:{},watch:{"ruleForm.createOption":function(e,t){console.log(e),1===e?this.ruleForm.channelNumVisible=!1:2===e&&(this.ruleForm.channelNumVisible=!0)}},created:function(){console.log("createDialog create"),!0===this.isEdit?(this.codeReadOnly=!0,this.ruleForm.channelId=this.editData["channel_code"],this.ruleForm.channelName=this.editData["channel_name"],this.ruleForm.channelUrl=this.editData["channel_page_url"]):this.codeReadOnly=!1,window.addEventListener("keydown",this.handkeyCode,!0)},methods:{confirm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return t.getNowTime(),console.log("error submit!!"),!1;t.isVisiable=!1;var a=t.ruleForm.channelUrl+"?appid="+Object(c["a"])()+"&channelCode="+t.ruleForm.channelId,n={ChannelCode:t.ruleForm.channelId,ChannelPageType:10,ChannelPageUrl:a,ChannelName:t.ruleForm.channelName};t.editData["id"]>0&&(n["Id"]=t.editData["id"]),t.createChannelRequest(n)}))},cancel:function(){this.isVisiable=!1,this.createSuccessBlock(!1,void 0)},handleClose:function(){this.isVisiable=!1,this.createSuccessBlock(!1,void 0)},getNowTime:function(){var e=new Date;console.log(e);var t=e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDay();return console.log(t),t},createChannelRequest:function(e){var t=this;this.listLoading=!0,Object(o["b"])(e).then((function(e){var a=e.data;console.log("createChannel:"+JSON.stringify(a)),t.listLoading=!1,t.createSuccessBlock(!1,a)}))},handkeyCode:function(e){console.log(e),13===e.keyCode&&(console.log("触发了回车/空格键"),this.confirm("ruleForm"))}}},u=s,d=a("2877"),h=Object(d["a"])(u,i,r,!1,null,null,null),m=h.exports,p={name:"Channels",components:{CreateDialog:m},data:function(){return{dialogFormVisible:!1,isDiaLogFormEdit:!1,pageSize:10,currentPage:1,total:0,tableData:[{id:0,user_id:0,app_id:"",channel_code:"",channel_name:"",channel_page_type:0,channel_page_url:"",created_at:"",updated_at:""}],editData:{id:0,channel_code:"",channel_name:"",channel_page_url:""}}},computed:{},created:function(){this.fetchData()},methods:{fetchData:function(){this.getRequestData(1)},getRequestData:function(e){var t=this;this.currentPage=e;var a={Page:this.currentPage,Limit:this.pageSize};this.listLoading=!0,Object(o["f"])(a).then((function(e){console.log("getChannelList:"+JSON.stringify(e)),t.tableData=e.data.data,t.total=e.data.total,t.listLoading=!1}))},linkJump:function(e){var t=e.channel_page_url;"https"===t.substr(0,5)||"http"===t.substr(0,4)?window.open(t,"_blank"):window.open("//"+t,"_blank")},changeClick:function(e){this.editData={id:e.id,channel_code:e.channel_code,channel_name:e.channel_name,channel_page_url:e.channel_page_url},this.isDiaLogFormEdit=!0,this.dialogFormVisible=!0},create:function(){this.editData={},this.isDiaLogFormEdit=!1,this.dialogFormVisible=!0},update:function(e,t){console.log("update"+e),this.dialogFormVisible=e,void 0!==t&&this.fetchData()},handleCurrentChange:function(e){this.getRequestData(e)}}},g=p,f=Object(d["a"])(g,n,l,!1,null,null,null);t["default"]=f.exports}}]);