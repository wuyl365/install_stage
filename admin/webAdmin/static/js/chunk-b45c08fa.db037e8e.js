(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b45c08fa"],{ad8f:function(e,t,n){"use strict";n.d(t,"d",(function(){return l})),n.d(t,"e",(function(){return i})),n.d(t,"g",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"h",(function(){return s})),n.d(t,"f",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"i",(function(){return h}));var a=n("b775");function l(e){return Object(a["a"])({url:"/admin/api/v1/application/detail",method:"get"})}function i(e){return Object(a["a"])({url:"/admin/api/v1/application/list",method:"get",params:e})}function r(e){return Object(a["a"])({url:"/admin/api/v1/channel/list",method:"get",params:e})}function o(e){return Object(a["a"])({url:"/admin/api/v1/channel/create",method:"post",data:e})}function c(e){return Object(a["a"])({url:"/admin/api/v1/channel/del",method:"delete",params:e})}function s(e){return Object(a["a"])({url:"/admin/api/v1/channel/statistic",method:"get",params:e})}function u(e){return Object(a["a"])({url:"/admin/api/v1/application/statistic",method:"get",params:e})}function d(e){return Object(a["a"])({url:"/admin/api/v1/application/create",method:"post",params:e})}function h(e){return Object(a["a"])({url:"/admin/api/v1/task/list",method:"get",params:e})}},fcd2:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"channels-container",staticStyle:{margin:"20px"}},[n("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.create(t)}}},[e._v("添加h5渠道")]),n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[n("el-table-column",{attrs:{fixed:"",prop:"channel_code",label:"渠道编号",width:"150"}}),n("el-table-column",{attrs:{fixed:"",prop:"channel_name",label:"渠道名称",width:"120"}}),n("el-table-column",{attrs:{fixed:"",prop:"channel_page_url",label:"渠道链接",width:"280"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",[n("a",{attrs:{href:"javascript:;"},on:{click:function(n){return e.linkJump(t.row)}}},[e._v(e._s(t.row.channel_page_url))])])]}}])}),n("el-table-column",{attrs:{fixed:"",prop:"created_at",label:"创建时间",width:"200"}}),n("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(n){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),n("div",{staticStyle:{"text-align":"center","margin-top":"20px",margin:"20px"}},[n("el-pagination",{attrs:{small:"small","current-page":e.currentPage,"page-size":e.pageSize,layout:"total, prev, pager, next, jumper",total:e.total},on:{"current-change":e.handleCurrentChange}})],1),e.dialogFormVisible?n("div",[n("CreateDialog",{attrs:{"is-show":e.dialogFormVisible,"create-success-block":e.update,"is-edit":e.isDiaLogFormEdit,"edit-data":e.editData}})],1):e._e()],1)},l=[],i=(n("e9c4"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{attrs:{visible:e.isVisiable,title:"新增H5渠道",width:"80%","before-close":e.handleClose},on:{"update:visible":function(t){e.isVisiable=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[n("span",{staticClass:"dialog-footer"},[n("el-button",{nativeOn:{click:function(t){return t.preventDefault(),e.cancel(t)}}},[e._v("取消")]),n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.confirm("ruleForm")}}},[e._v(" 确认 ")])],1)]},proxy:!0}])},[n("el-form",{ref:"ruleForm",attrs:{"label-width":"180px",model:e.ruleForm,rules:e.rules}},[n("el-form-item",{attrs:{label:"渠道编号",prop:"channelId"}},[n("el-input",{attrs:{readonly:e.codeReadOnly,placeholder:"请输入渠道编号"},model:{value:e.ruleForm.channelId,callback:function(t){e.$set(e.ruleForm,"channelId",t)},expression:"ruleForm.channelId"}})],1),n("el-form-item",{attrs:{label:"渠道名称",prop:"channelName"}},[n("el-input",{attrs:{placeholder:"请输入渠道名称"},model:{value:e.ruleForm.channelName,callback:function(t){e.$set(e.ruleForm,"channelName",t)},expression:"ruleForm.channelName"}})],1),n("el-form-item",{attrs:{label:"落地页URL",prop:"channelUrl"}},[n("el-input",{attrs:{placeholder:"请输入渠道名称"},model:{value:e.ruleForm.channelUrl,callback:function(t){e.$set(e.ruleForm,"channelUrl",t)},expression:"ruleForm.channelUrl"}})],1)],1)],1)}),r=[],o=n("ad8f"),c=n("5f87"),s={name:"CreateDialog",props:{isShow:Boolean,createSuccessBlock:Function,isEdit:Boolean,editData:Object},data:function(){return{ruleForm:{channelId:"",channelName:"",channelUrl:""},rules:{channelId:[{required:!0,message:"请输入渠道编号",trigger:"blur"},{min:1,max:100,message:"长度在 1 到 100 个字符",trigger:"blur"}],channelName:[{required:!0,message:"请输入渠道名称",trigger:"blur"},{min:1,max:100,message:"长度在 1 到 100 个字符",trigger:"blur"}],channelUrl:[{required:!0,message:"请输入落地页url",trigger:"blur"},{min:1,max:100,message:"长度在 1 到 100 个字符",trigger:"blur"}]},isVisiable:this.isShow,codeReadOnly:!1}},computed:{},watch:{"ruleForm.createOption":function(e,t){console.log(e),1===e?this.ruleForm.channelNumVisible=!1:2===e&&(this.ruleForm.channelNumVisible=!0)}},created:function(){console.log("createDialog create"),!0===this.isEdit?(this.codeReadOnly=!0,this.ruleForm.channelId=this.editData["channel_code"],this.ruleForm.channelName=this.editData["channel_name"],this.ruleForm.channelUrl=this.editData["channel_page_url"]):this.codeReadOnly=!1,window.addEventListener("keydown",this.handkeyCode,!0)},methods:{confirm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return t.getNowTime(),console.log("error submit!!"),!1;t.isVisiable=!1;var n=t.ruleForm.channelUrl+"?appid="+Object(c["a"])()+"&channelCode="+encodeURIComponent(t.ruleForm.channelId),a={ChannelCode:t.ruleForm.channelId,ChannelPageType:10,ChannelPageUrl:n,ChannelName:t.ruleForm.channelName};t.editData["id"]>0&&(a["Id"]=t.editData["id"]),t.createChannelRequest(a)}))},cancel:function(){this.isVisiable=!1,this.createSuccessBlock(!1,void 0)},handleClose:function(){this.isVisiable=!1,this.createSuccessBlock(!1,void 0)},getNowTime:function(){var e=new Date;console.log(e);var t=e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDay();return console.log(t),t},createChannelRequest:function(e){var t=this;this.listLoading=!0,Object(o["b"])(e).then((function(e){var n=e.data;console.log("createChannel:"+JSON.stringify(n)),t.listLoading=!1,t.createSuccessBlock(!1,n)})).catch((function(e){console.log(e),t.createSuccessBlock(!1,void 0)}))},handkeyCode:function(e){console.log(e),13===e.keyCode&&(console.log("触发了回车/空格键"),this.confirm("ruleForm"))}}},u=s,d=n("2877"),h=Object(d["a"])(u,i,r,!1,null,null,null),m=h.exports,p={name:"Channels",components:{CreateDialog:m},data:function(){return{dialogFormVisible:!1,isDiaLogFormEdit:!1,pageSize:10,currentPage:1,total:0,tableData:[{id:0,user_id:0,app_id:"",channel_code:"",channel_name:"",channel_page_type:0,channel_page_url:"",created_at:"",updated_at:""}],editData:{id:0,channel_code:"",channel_name:"",channel_page_url:""}}},computed:{},created:function(){this.fetchData()},methods:{fetchData:function(){this.getRequestData(1)},getRequestData:function(e){var t=this;this.currentPage=e;var n={Page:this.currentPage,Limit:this.pageSize};this.listLoading=!0,Object(o["g"])(n).then((function(e){console.log("getChannelList:"+JSON.stringify(e)),t.tableData=e.data.data,t.total=e.data.total,t.listLoading=!1}))},linkJump:function(e){var t=e.channel_page_url;"https"===t.substr(0,5)||"http"===t.substr(0,4)?window.open(t,"_blank"):window.open("//"+t,"_blank")},changeClick:function(e){this.editData={id:e.id,channel_code:e.channel_code,channel_name:e.channel_name,channel_page_url:e.channel_page_url},this.isDiaLogFormEdit=!0,this.dialogFormVisible=!0},create:function(){this.editData={},this.isDiaLogFormEdit=!1,this.dialogFormVisible=!0},update:function(e,t){console.log("update"+e),this.dialogFormVisible=e,void 0!==t&&this.fetchData()},handleCurrentChange:function(e){this.getRequestData(e)},handleDelete:function(e,t){var n=this;console.log(e,t),t.id>0&&this.$confirm("是否确认删除渠道："+t.channel_name+"?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var e={Id:t.id};Object(o["c"])(e).then((function(e){n.$message({type:"success",message:"删除成功!"}),n.fetchData()}))})).catch((function(){n.$message({type:"info",message:"已取消删除"})}))}}},g=p,f=Object(d["a"])(g,a,l,!1,null,null,null);t["default"]=f.exports}}]);